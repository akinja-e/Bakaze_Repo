<!-- sections/template-customer-order.liquid -->

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <div class="mb-8">
    <a href="{{ routes.account_url }}" class="text-sm text-blue-600 hover:text-blue-500 mb-2 inline-block">
      ← Back to Account
    </a>
    <div class="flex justify-between items-start">
      <div>
        <h1 class="text-3xl font-bold text-gray-900">Order {{ order.name }}</h1>
        <p class="mt-1 text-sm text-gray-500">Placed on {{ order.created_at | date: format: 'date' }}</p>
      </div>
      <span
        class="
          inline-flex items-center px-3 py-1 rounded-full text-sm font-medium
          {% if order.financial_status == 'paid' %}bg-green-100 text-green-800
          {% elsif order.financial_status == 'pending' %}bg-yellow-100 text-yellow-800
          {% else %}bg-gray-100 text-gray-800{% endif %}
        "
      >
        {{ order.financial_status }}
      </span>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Order Items -->
    <div class="lg:col-span-2">
      <div class="bg-white rounded-lg shadow overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-200">
          <h2 class="text-lg font-medium text-gray-900">Order Items</h2>
        </div>

        <div class="divide-y divide-gray-200">
          {% for line_item in order.line_items %}
            <div class="p-6 flex">
              <div class="flex-shrink-0 w-24 h-24">
                {% if line_item.image %}
                  <img
                    src="{{ line_item.image | image_url: width: 200 }}"
                    alt="{{ line_item.title | escape }}"
                    class="w-full h-full object-cover rounded"
                    width="200"
                    height="200"
                    loading="lazy"
                  >
                {% else %}
                  {{ 'product-1' | placeholder_svg_tag: 'w-full h-full object-cover rounded' }}
                {% endif %}
              </div>

              <div class="ml-6 flex-1">
                <div class="flex justify-between">
                  <div>
                    <h3 class="text-base font-medium text-gray-900">
                      <a href="{{ line_item.product.url }}" class="hover:text-gray-700">{{ line_item.title }}</a>
                    </h3>
                    {% if line_item.variant.title != 'Default Title' %}
                      <p class="mt-1 text-sm text-gray-500">{{ line_item.variant.title }}</p>
                    {% endif %}
                    {% if line_item.sku != blank %}
                      <p class="mt-1 text-sm text-gray-500">SKU: {{ line_item.sku }}</p>
                    {% endif %}
                  </div>

                  <div class="text-right">
                    <p class="text-base font-medium text-gray-900">{{ line_item.final_line_price | money }}</p>
                    <p class="mt-1 text-sm text-gray-500">
                      {{ line_item.original_price | money }} × {{ line_item.quantity }}
                    </p>
                  </div>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>

        <div class="bg-gray-50 px-6 py-4">
          <dl class="space-y-2">
            <div class="flex justify-between text-sm">
              <dt class="text-gray-600">Subtotal</dt>
              <dd class="text-gray-900 font-medium">{{ order.line_items_subtotal_price | money }}</dd>
            </div>

            {% if order.total_discounts > 0 %}
              <div class="flex justify-between text-sm">
                <dt class="text-gray-600">Discounts</dt>
                <dd class="text-green-600 font-medium">-{{ order.total_discounts | money }}</dd>
              </div>
            {% endif %}

            {% for shipping_method in order.shipping_methods %}
              <div class="flex justify-between text-sm">
                <dt class="text-gray-600">Shipping ({{ shipping_method.title }})</dt>
                <dd class="text-gray-900 font-medium">{{ shipping_method.price | money }}</dd>
              </div>
            {% endfor %}

            {% if order.total_tax > 0 %}
              <div class="flex justify-between text-sm">
                <dt class="text-gray-600">Tax</dt>
                <dd class="text-gray-900 font-medium">{{ order.total_tax | money }}</dd>
              </div>
            {% endif %}

            <div class="flex justify-between text-base font-medium pt-2 border-t border-gray-200">
              <dt class="text-gray-900">Total</dt>
              <dd class="text-gray-900">{{ order.total_price | money }}</dd>
            </div>
          </dl>
        </div>
      </div>
    </div>

    <!-- Sidebar -->
    <div class="lg:col-span-1 space-y-6">
      <!-- Billing Address -->
      <div class="bg-white rounded-lg shadow p-6">
        <h2 class="text-lg font-medium text-gray-900 mb-4">Billing Address</h2>
        <div class="text-sm text-gray-600">
          <p class="font-medium text-gray-900">{{ order.billing_address.name }}</p>
          {% if order.billing_address.company != blank %}
            <p>{{ order.billing_address.company }}</p>
          {% endif %}
          <p>{{ order.billing_address.street }}</p>
          <p>{{ order.billing_address.city }}, {{ order.billing_address.province }}</p>
          <p>
            {{ order.billing_address.country }}
            {{ order.billing_address.zip }}
          </p>
          {% if order.billing_address.phone != blank %}
            <p class="mt-2">{{ order.billing_address.phone }}</p>
          {% endif %}
        </div>

        <div class="mt-4 pt-4 border-t border-gray-200">
          <div class="flex items-center">
            <span class="text-sm font-medium text-gray-500">Payment Status:</span>
            <span
              class="
                ml-2 px-2 py-0.5 rounded-full text-xs font-medium
                {% if order.financial_status == 'paid' %}bg-green-100 text-green-800
                {% elsif order.financial_status == 'pending' %}bg-yellow-100 text-yellow-800
                {% else %}bg-gray-100 text-gray-800{% endif %}
              "
            >
              {{ order.financial_status }}
            </span>
          </div>
        </div>
      </div>

      <!-- Shipping Address -->
      <div class="bg-white rounded-lg shadow p-6">
        <h2 class="text-lg font-medium text-gray-900 mb-4">Shipping Address</h2>
        <div class="text-sm text-gray-600">
          <p class="font-medium text-gray-900">{{ order.shipping_address.name }}</p>
          {% if order.shipping_address.company != blank %}
            <p>{{ order.shipping_address.company }}</p>
          {% endif %}
          <p>{{ order.shipping_address.street }}</p>
          <p>{{ order.shipping_address.city }}, {{ order.shipping_address.province }}</p>
          <p>
            {{ order.shipping_address.country }}
            {{ order.shipping_address.zip }}
          </p>
          {% if order.shipping_address.phone != blank %}
            <p class="mt-2">{{ order.shipping_address.phone }}</p>
          {% endif %}
        </div>

        <div class="mt-4 pt-4 border-t border-gray-200">
          <div class="flex items-center">
            <span class="text-sm font-medium text-gray-500">Fulfillment:</span>
            <span
              class="
                ml-2 px-2 py-0.5 rounded-full text-xs font-medium
                {% if order.fulfillment_status == 'fulfilled' %}bg-green-100 text-green-800
                {% elsif order.fulfillment_status == 'partial' %}bg-blue-100 text-blue-800
                {% else %}bg-gray-100 text-gray-800{% endif %}
              "
            >
              {{ order.fulfillment_status | default: 'unfulfilled' }}
            </span>
          </div>
        </div>
      </div>

      <!-- Help -->
      <div class="bg-white rounded-lg shadow p-6">
        <h2 class="text-lg font-medium text-gray-900 mb-4">Need Help?</h2>
        <p class="text-sm text-gray-600 mb-4">
          If you have any questions about your order, please contact our support team.
        </p>
        <a
          href="{{ routes.contact_url }}"
          class="block w-full text-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"
        >
          Contact Support
        </a>
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Customer Order",
  "settings": []
}
{% endschema %}
