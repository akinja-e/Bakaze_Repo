<!-- sections/template-customer-addresses.liquid -->

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <div class="mb-8">
    <a href="{{ routes.account_url }}" class="text-sm text-blue-600 hover:text-blue-500 mb-2 inline-block">
      â† Back to Account
    </a>
    <h1 class="text-3xl font-bold text-gray-900">Manage Addresses</h1>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Add New Address Form -->
    <div class="bg-white rounded-lg shadow p-6">
      <h2 class="text-xl font-bold text-gray-900 mb-4">Add New Address</h2>

      {% form 'customer_address', customer.new_address %}
        {% if form.errors %}
          <div class="bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded relative mb-4">
            <strong class="font-bold">Please correct the following:</strong>
            <ul class="list-disc list-inside mt-2">
              {% for error in form.errors %}
                <li>{{ form.errors.messages[error] }}</li>
              {% endfor %}
            </ul>
          </div>
        {% endif %}

        <div class="space-y-4">
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label for="first_name" class="block text-sm font-medium text-gray-700 mb-1">
                First Name <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="first_name"
                name="address[first_name]"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-gray-900 focus:border-gray-900"
              >
            </div>

            <div>
              <label for="last_name" class="block text-sm font-medium text-gray-700 mb-1">
                Last Name <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="last_name"
                name="address[last_name]"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-gray-900 focus:border-gray-900"
              >
            </div>
          </div>

          <div>
            <label for="company" class="block text-sm font-medium text-gray-700 mb-1">Company</label>
            <input
              type="text"
              id="company"
              name="address[company]"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-gray-900 focus:border-gray-900"
            >
          </div>

          <div>
            <label for="address1" class="block text-sm font-medium text-gray-700 mb-1">
              Address <span class="text-red-500">*</span>
            </label>
            <input
              type="text"
              id="address1"
              name="address[address1]"
              required
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-gray-900 focus:border-gray-900"
            >
          </div>

          <div>
            <label for="address2" class="block text-sm font-medium text-gray-700 mb-1">Apartment, suite, etc.</label>
            <input
              type="text"
              id="address2"
              name="address[address2]"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-gray-900 focus:border-gray-900"
            >
          </div>

          <div>
            <label for="city" class="block text-sm font-medium text-gray-700 mb-1">
              City <span class="text-red-500">*</span>
            </label>
            <input
              type="text"
              id="city"
              name="address[city]"
              required
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-gray-900 focus:border-gray-900"
            >
          </div>

          <div class="grid grid-cols-2 gap-4">
            <div>
              <label for="country" class="block text-sm font-medium text-gray-700 mb-1">
                Country <span class="text-red-500">*</span>
              </label>
              <select
                id="country"
                name="address[country]"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-gray-900 focus:border-gray-900"
              >
                {{ country_option_tags }}
              </select>
            </div>

            <div>
              <label for="province" class="block text-sm font-medium text-gray-700 mb-1">Province/State</label>
              <select
                id="province"
                name="address[province]"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-gray-900 focus:border-gray-900"
              >
                <option value="">Select...</option>
              </select>
            </div>
          </div>

          <div class="grid grid-cols-2 gap-4">
            <div>
              <label for="zip" class="block text-sm font-medium text-gray-700 mb-1">
                Postal/Zip Code <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="zip"
                name="address[zip]"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-gray-900 focus:border-gray-900"
              >
            </div>

            <div>
              <label for="phone" class="block text-sm font-medium text-gray-700 mb-1">Phone</label>
              <input
                type="tel"
                id="phone"
                name="address[phone]"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-gray-900 focus:border-gray-900"
              >
            </div>
          </div>

          <div class="flex items-center">
            <input
              type="checkbox"
              id="default_address"
              name="address[default]"
              value="1"
              class="h-4 w-4 text-gray-900 focus:ring-gray-900 border-gray-300 rounded"
            >
            <label for="default_address" class="ml-2 block text-sm text-gray-700">Set as default address</label>
          </div>

          <div>
            <button
              type="submit"
              class="w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-gray-900 hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-900"
            >
              Add Address
            </button>
          </div>
        </div>
      {% endform %}
    </div>

    <!-- Existing Addresses -->
    <div>
      <h2 class="text-xl font-bold text-gray-900 mb-4">Your Addresses</h2>

      {% if customer.addresses.size > 0 %}
        <div class="space-y-4">
          {% for address in customer.addresses %}
            <div class="bg-white rounded-lg shadow p-6 relative">
              {% if address == customer.default_address %}
                <span class="absolute top-4 right-4 px-2 py-1 text-xs font-semibold text-white bg-gray-900 rounded"
                  >Default</span
                >
              {% endif %}

              <div class="mb-4">
                <p class="font-medium text-gray-900">
                  {{ address.first_name }}
                  {{ address.last_name }}
                </p>
                {% if address.company != blank %}
                  <p class="text-gray-600">{{ address.company }}</p>
                {% endif %}
                <p class="text-gray-600">{{ address.address1 }}</p>
                {% if address.address2 != blank %}
                  <p class="text-gray-600">{{ address.address2 }}</p>
                {% endif %}
                <p class="text-gray-600">
                  {{ address.city -}}
                  {%- if address.province_code %}, {{ address.province_code }}{% endif %}
                  {{ address.zip }}
                </p>
                <p class="text-gray-600">{{ address.country }}</p>
                {% if address.phone != blank %}
                  <p class="text-gray-600">{{ address.phone }}</p>
                {% endif %}
              </div>

              <div class="flex space-x-4">
                <button
                  type="button"
                  onclick="alert('Edit functionality requires JavaScript')"
                  class="text-sm text-blue-600 hover:text-blue-500"
                >
                  Edit
                </button>
                <button
                  type="button"
                  onclick="if(confirm('Delete this address?')) { document.getElementById('delete-{{ address.id }}').submit(); }"
                  class="text-sm text-red-600 hover:text-red-500"
                >
                  Delete
                </button>
              </div>

              <form
                id="delete-{{ address.id }}"
                method="post"
                action="{{ routes.account_addresses_url }}/{{ address.id }}"
                style="display: none;"
              >
                <input type="hidden" name="_method" value="delete">
              </form>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="bg-white rounded-lg shadow p-6 text-center">
          <p class="text-gray-500">No addresses saved yet. Add your first address using the form on the left.</p>
        </div>
      {% endif %}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Customer Addresses",
  "settings": []
}
{% endschema %}
