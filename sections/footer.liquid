{% assign footer_menu_1 = linklists[section.settings.footer_menu_1].links %}
{% assign footer_menu_2 = linklists[section.settings.footer_menu_2].links %}
{% assign footer_menu_3 = linklists[section.settings.footer_menu_3].links %}

<footer class="bg-gray-900 text-white">
  <!-- Main Footer Content -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 lg:py-16">
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 lg:gap-12">
      <!-- Column 1: Brand Info -->
      <div class="sm:col-span-2 lg:col-span-1">
        <a href="{{ routes.root_url }}" class="text-xl font-bold text-white">
          {{ shop.name }}
        </a>

        {% if section.settings.footer_description != blank %}
          <p class="mt-4 text-gray-400 text-sm leading-relaxed">
            {{ section.settings.footer_description }}
          </p>
        {% endif %}

        {% if section.settings.email_address != blank %}
          <div class="mt-4">
            <a
              href="mailto:{{ section.settings.email_address }}"
              class="inline-flex items-center gap-2 text-gray-400 hover:text-white text-sm transition"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
              </svg>
              {{ section.settings.email_address }}
            </a>
          </div>
        {% endif %}

        <!-- Social Links -->
        {% if section.settings.social_facebook != blank or section.settings.social_tiktok != blank %}
          <div class="flex items-center gap-4 mt-6">
            {% if section.settings.social_facebook != blank %}
              <a
                href="{{ section.settings.social_facebook }}"
                target="_blank"
                rel="noopener noreferrer"
                class="text-gray-400 hover:text-white transition"
                aria-label="Facebook"
              >
                {% render 'icon-facebook', class: 'w-5 h-5' %}
              </a>
            {% endif %}

            {% if section.settings.social_tiktok != blank %}
              <a
                href="{{ section.settings.social_tiktok }}"
                target="_blank"
                rel="noopener noreferrer"
                class="text-gray-400 hover:text-white transition"
                aria-label="TikTok"
              >
                {% render 'icon-tiktok', class: 'w-5 h-5' %}
              </a>
            {% endif %}
            {% if section.settings.social_instagram != blank %}
              <a
                href="{{ section.settings.social_instagram }}"
                target="_blank"
                rel="noopener noreferrer"
                class="text-gray-400 hover:text-white transition"
                aria-label="Instagram"
              >
                {% render 'icon-instagram', class: 'w-5 h-5' %}
              </a>
            {% endif %}
          </div>
        {% endif %}
      </div>

      <!-- Column 2: Menu 1 -->
      <div>
        <h3 class="text-sm font-semibold text-white uppercase tracking-wider">
          {{ section.settings.menu_title_1 }}
        </h3>
        <ul class="mt-4 space-y-3">
          {% for link in footer_menu_1 %}
            <li>
              <a
                href="{{ link.url }}"
                class="text-gray-400 hover:text-white text-sm transition"
              >
                {{ link.title }}
              </a>
            </li>
          {% endfor %}
        </ul>
      </div>

      <!-- Column 3: Menu 2 -->
      <div>
        <h3 class="text-sm font-semibold text-white uppercase tracking-wider">
          {{ section.settings.menu_title_2 }}
        </h3>
        <ul class="mt-4 space-y-3">
          {% for link in footer_menu_2 %}
            <li>
              <a
                href="{{ link.url }}"
                class="text-gray-400 hover:text-white text-sm transition"
              >
                {{ link.title }}
              </a>
            </li>
          {% endfor %}
        </ul>
      </div>

      <!-- Column 4: Menu 3 -->
      <div>
        <h3 class="text-sm font-semibold text-white uppercase tracking-wider">
          {{ section.settings.menu_title_3 }}
        </h3>
        <ul class="mt-4 space-y-3">
          {% for link in footer_menu_3 %}
            <li>
              <a
                href="{{ link.url }}"
                class="text-gray-400 hover:text-white text-sm transition"
              >
                {{ link.title }}
              </a>
            </li>
          {% endfor %}
        </ul>
      </div>
    </div>

    <!-- Newsletter Section -->
    {% if section.settings.show_newsletter %}
      <div class="mt-12 pt-8 border-t border-gray-800">
        <div class="lg:flex lg:items-center lg:justify-between">
          <div class="lg:w-1/2">
            <h3 class="text-lg font-semibold text-white">
              {{ section.settings.newsletter_heading }}
            </h3>
            {% if section.settings.newsletter_description != blank %}
              <p class="mt-2 text-gray-400 text-sm">
                {{ section.settings.newsletter_description }}
              </p>
            {% endif %}
          </div>

          <div class="mt-6 lg:mt-0 lg:w-1/2 lg:max-w-md lg:ml-8">
            {% form 'customer', id: 'footer-newsletter-form' %}
              <input type="hidden" name="contact[tags]" value="newsletter">

              {% if form.posted_successfully? %}
                <p class="text-green-400 text-sm">Thanks for subscribing!</p>
              {% else %}
                <div class="flex flex-col sm:flex-row gap-3">
                  <input
                    type="email"
                    name="contact[email]"
                    placeholder="Enter your email"
                    required
                    autocomplete="email"
                    class="flex-1 px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-white focus:border-transparent transition"
                  >
                  <button
                    type="submit"
                    class="px-6 py-3 bg-white text-gray-900 font-semibold text-sm rounded-lg hover:bg-gray-100 transition flex-shrink-0"
                  >
                    Subscribe
                  </button>
                </div>

                {% if form.errors %}
                  <p class="mt-2 text-red-400 text-sm">
                    {{ form.errors.messages.email }}
                  </p>
                {% endif %}
              {% endif %}
            {% endform %}
          </div>
        </div>
      </div>
    {% endif %}
  </div>

  <!-- Bottom Bar -->
  <div class="border-t border-gray-800">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
      <div class="md:flex md:items-center md:justify-between">
        <!-- Copyright -->
        <p class="text-gray-400 text-sm">
          &copy; {{ 'now' | date: '%Y' }}
          {{ shop.name }}. All rights reserved.
        </p>

        <!-- Payment Icons -->
        {% if section.settings.show_payment_icons %}
          <div class="mt-4 md:mt-0 flex flex-wrap items-center gap-2">
            {% for type in shop.enabled_payment_types %}
              {{ type | payment_type_svg_tag: class: 'h-8 w-auto' }}
            {% endfor %}
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</footer>

<!-- Back to Top Button -->
<div
  x-data="backToTop()"
  x-on:scroll.window="handleScroll()"
>
  <button
    x-show="visible"
    x-transition:enter="transition ease-out duration-300"
    x-transition:enter-start="opacity-0 translate-y-4"
    x-transition:enter-end="opacity-100 translate-y-0"
    x-transition:leave="transition ease-in duration-200"
    x-transition:leave-start="opacity-100 translate-y-0"
    x-transition:leave-end="opacity-0 translate-y-4"
    x-on:click="scrollToTop()"
    x-cloak
    type="button"
    class="fixed bottom-6 right-6 z-50 p-3 bg-gray-900 text-white rounded-full shadow-lg hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-gray-900 focus:ring-offset-2 transition"
    aria-label="Back to top"
  >
    {% render 'icon-arrow-up', class: 'w-5 h-5' %}
  </button>
</div>

<script>
  document.addEventListener('alpine:init', () => {
    Alpine.data('backToTop', () => ({
      visible: false,
      threshold: 300,

      handleScroll() {
        this.visible = window.scrollY > this.threshold;
      },

      scrollToTop() {
        window.scrollTo({
          top: 0,
          behavior: 'smooth',
        });
      },
    }));
  });
</script>

{% schema %}
{
  "name": "Footer",
  "settings": [
    {
      "type": "header",
      "content": "Brand"
    },
    {
      "type": "textarea",
      "id": "footer_description",
      "label": "Store Description",
      "default": "Your trusted online store for quality products. We deliver excellence with every order."
    },
    {
      "type": "text",
      "id": "email_address",
      "label": "Email Address",
      "placeholder": "support@example.com"
    },
    {
      "type": "header",
      "content": "Menu 1"
    },
    {
      "type": "text",
      "id": "menu_title_1",
      "label": "Menu Title",
      "default": "Quick Links"
    },
    {
      "type": "link_list",
      "id": "footer_menu_1",
      "label": "Menu",
      "default": "main-menu"
    },
    {
      "type": "header",
      "content": "Menu 2"
    },
    {
      "type": "text",
      "id": "menu_title_2",
      "label": "Menu Title",
      "default": "Customer Service"
    },
    {
      "type": "link_list",
      "id": "footer_menu_2",
      "label": "Menu"
    },
    {
      "type": "header",
      "content": "Menu 3"
    },
    {
      "type": "text",
      "id": "menu_title_3",
      "label": "Menu Title",
      "default": "Information"
    },
    {
      "type": "link_list",
      "id": "footer_menu_3",
      "label": "Menu"
    },
    {
      "type": "header",
      "content": "Newsletter"
    },
    {
      "type": "checkbox",
      "id": "show_newsletter",
      "label": "Show Newsletter",
      "default": true
    },
    {
      "type": "text",
      "id": "newsletter_heading",
      "label": "Heading",
      "default": "Subscribe to our newsletter"
    },
    {
      "type": "textarea",
      "id": "newsletter_description",
      "label": "Description",
      "default": "Get the latest updates on new products and upcoming sales."
    },
    {
      "type": "header",
      "content": "Social Media"
    },
    {
      "type": "url",
      "id": "social_facebook",
      "label": "Facebook URL"
    },
    {
      "type": "url",
      "id": "social_tiktok",
      "label": "TikTok URL"
    },
    {
      "type": "url",
      "id": "social_instagram",
      "label": "Instagram URL"
    },
    {
      "type": "header",
      "content": "Bottom Bar"
    },
    {
      "type": "checkbox",
      "id": "show_payment_icons",
      "label": "Show Payment Icons",
      "default": true
    }
  ]
}
{% endschema %}
